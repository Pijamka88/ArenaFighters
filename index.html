<!DOCTYPE html>
<html>
<head>
    <title>Dark Arena Evolution</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        /* –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –ø—Ä–µ–∂–Ω–∏–º–∏ */
        /* –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ —Å—Ç–∏–ª–∏ */
        @keyframes hit {
            0% { transform: translateX(0); }
            25% { transform: translateX(10px); }
            50% { transform: translateX(-10px); }
            100% { transform: translateX(0); }
        }
        .hit-animation { animation: hit 0.3s linear; }
        .achievement { color: #FFD700; font-weight: bold; }
    </style>
</head>
<body>
    <!-- –û—Å—Ç–∞–ª—å–Ω–∞—è —Ä–∞–∑–º–µ—Ç–∫–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –ø—Ä–µ–∂–Ω–µ–π -->
    <div id="upgradeModal" class="hidden modal">
        <h3>–£–ª—É—á—à–µ–Ω–∏—è</h3>
        <button class="button" onclick="upgradeStat('attack')">‚öîÔ∏è +5 –ê—Ç–∞–∫–∏ (50üí∞)</button>
        <button class="button" onclick="upgradeStat('health')">‚ù§Ô∏è +20 –ó–¥–æ—Ä–æ–≤—å—è (50üí∞)</button>
        <button class="button" onclick="upgradeStat('defense')">üõ°Ô∏è +3 –ó–∞—â–∏—Ç—ã (75üí∞)</button>
        <button class="button" onclick="hideUpgrades()">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>

    <script>
        // –†–∞—Å—à–∏—Ä—è–µ–º –æ–±—ä–µ–∫—Ç –∏–≥—Ä–æ–∫–∞
        let player = {
            level: 1,
            xp: 0,
            coins: 0,
            attack: 10,
            defense: 0,
            health: 100,
            maxHealth: 100,
            wins: 0,
            achievements: []
        };

        // –°–∏—Å—Ç–µ–º–∞ –≤—Ä–∞–≥–æ–≤
        const ENEMY_TYPES = {
            WARRIOR: { icon: 'üõ°Ô∏è', attack: 15, defense: 5 },
            ARCHER: { icon: 'üèπ', attack: 20, defense: 2 },
            MAGE: { icon: 'üîÆ', attack: 25, defense: 0 }
        };

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
        function loadGame() {
            const saved = localStorage.getItem('arenaSave');
            if(saved) Object.assign(player, JSON.parse(saved));
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–≥—Ä—ã
        function saveGame() {
            localStorage.setItem('arenaSave', JSON.stringify(player));
        }

        // –£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –±–æ—è
        function fightRound() {
            // –ê—Ç–∞–∫–∞ –∏–≥—Ä–æ–∫–∞
            const crit = Math.random() < 0.2;
            const playerDamage = Math.max(0, (player.attack * (crit ? 1.5 : 1)) - currentEnemy.defense;
            currentEnemy.health -= playerDamage;
            document.getElementById('enemyIcon').classList.add('hit-animation');
            logBattle(`${crit ? '–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –£–î–ê–†! ' : ''}–í—ã –Ω–∞–Ω–µ—Å–ª–∏ ${playerDamage} —É—Ä–æ–Ω–∞!`);

            // –ê—Ç–∞–∫–∞ –≤—Ä–∞–≥–∞
            const enemyDamage = Math.max(0, currentEnemy.attack - player.defense);
            player.health -= enemyDamage;
            document.getElementById('playerIcon').classList.add('hit-animation');
            logBattle(`–í—Ä–∞–≥ –Ω–∞–Ω–µ—Å ${enemyDamage} —É—Ä–æ–Ω–∞!`);

            setTimeout(() => {
                document.getElementById('enemyIcon').classList.remove('hit-animation');
                document.getElementById('playerIcon').classList.remove('hit-animation');
            }, 300);

            updateHealthBars();

            if(currentEnemy.health <= 0) endBattle(true);
            else if(player.health <= 0) endBattle(false);
        }

        // –°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
        const ACHIEVEMENTS = [
            { condition: p => p.wins >= 5, title: "–ù–æ–≤–∏—á–æ–∫ –∞—Ä–µ–Ω—ã", done: false },
            { condition: p => p.coins >= 200, title: "–ë–æ–≥–∞—á", done: false },
            { condition: p => p.wins >= 10, title: "–û–ø—ã—Ç–Ω—ã–π –±–æ–µ—Ü", done: false }
        ];

        function checkAchievements() {
            ACHIEVEMENTS.forEach(ach => {
                if(!ach.done && ach.condition(player)) {
                    logBattle(`<span class="achievement">–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ: ${ach.title}!</span>`);
                    ach.done = true;
                    player.achievements.push(ach.title);
                }
            });
        }

        // –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –≤—Ä–∞–≥–∞
        function createEnemy(isBoss = false) {
            const type = Object.values(ENEMY_TYPES)[Math.floor(Math.random() * 3)];
            return {
                ...type,
                health: isBoss ? 500 : 100 + player.wins * 30,
                attack: type.attack * (isBoss ? 2 : 1) + player.wins * 5,
                defense: type.defense + player.wins * 2,
                icon: isBoss ? 'üêâ' : type.icon
            };
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é —É–ª—É—á—à–µ–Ω–∏–π
        function upgradeStat(stat) {
            const costs = { attack: 50, health: 50, defense: 75 };
            if(player.coins >= costs[stat]) {
                player.coins -= costs[stat];
                if(stat === 'attack') player.attack += 5;
                if(stat === 'health') player.maxHealth += 20;
                if(stat === 'defense') player.defense += 3;
                updateStatsDisplay();
                saveGame();
                hideUpgrades();
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        window.onload = () => {
            loadGame();
            updateStatsDisplay();
        };

        // –î–æ–±–∞–≤–ª—è–µ–º –≤—ã–∑–æ–≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
        function endBattle(victory) {
            // ... –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∫–æ–¥ ...
            checkAchievements();
            saveGame();
        }
    </script>
</body>
</html>