<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chaos Arena</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: linear-gradient(135deg, #1a1a1a, #2d004d);
            font-family: 'Arial', sans-serif;
            color: #e0e0e0;
        }

        #menu {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        .menu-button {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid #6a00ff;
            padding: 15px 30px;
            margin: 10px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.2em;
        }

        .menu-button:hover {
            background: rgba(106, 0, 255, 0.3);
            transform: scale(1.1);
        }

        #game-screen {
            display: none;
            position: relative;
            width: 100vw;
            height: 100vh;
        }

        .health-bar {
            position: absolute;
            top: 20px;
            width: 30%;
            height: 30px;
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid #ff0000;
            border-radius: 15px;
        }

        #player-health {
            left: 20px;
        }

        #enemy-health {
            right: 20px;
        }

        .health-fill {
            height: 100%;
            background: linear-gradient(to right, #ff0000, #ff4d00);
            border-radius: 15px;
            transition: width 0.5s;
        }

        .character {
            position: absolute;
            bottom: 50px;
            width: 200px;
            height: 200px;
            background-size: cover;
            animation: float 2s infinite ease-in-out;
        }

        #player {
            left: 50px;
            background-image: url('https://i.imgur.com/6QbX6yA.png');
        }

        #enemy {
            right: 50px;
            background-image: url('https://i.imgur.com/3uRfL8n.png');
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .damage-text {
            position: absolute;
            color: #ff4d4d;
            font-weight: bold;
            font-size: 24px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            animation: floatUp 1s forwards;
        }

        @keyframes floatUp {
            0% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-50px); }
        }

        #upgrade-menu {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        .upgrade-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid #00ff99;
            padding: 10px 20px;
            margin: 10px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1em;
        }

        .upgrade-btn:hover {
            background: rgba(0, 255, 153, 0.3);
            transform: scale(1.05);
        }

        #status {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            font-size: 1.2em;
        }
    </style>
</head>
<body>
    <div id="menu">
        <div class="menu-button" onclick="startGame()">Начать бой</div>
        <div class="menu-button" onclick="showUpgrades()">Прокачка</div>
    </div>

    <div id="game-screen">
        <div id="player-health" class="health-bar">
            <div class="health-fill" id="player-health-fill"></div>
        </div>
        <div id="enemy-health" class="health-bar">
            <div class="health-fill" id="enemy-health-fill"></div>
        </div>
        
        <div id="player" class="character"></div>
        <div id="enemy" class="character"></div>
        
        <div id="status"></div>
    </div>

    <div id="upgrade-menu">
        <div class="upgrade-btn" onclick="upgrade('attack')">Атака (+1)</div>
        <div class="upgrade-btn" onclick="upgrade('health')">Жизнь (+10)</div>
        <div class="upgrade-btn" onclick="upgrade('armor')">Броня (+1)</div>
        <div class="menu-button" onclick="showMenu()">Назад</div>
    </div>

    <script>
        let player = {
            level: 1,
            xp: 0,
            xpRequired: 10,
            attack: 5,
            maxHealth: 100,
            health: 100,
            armor: 0,
            skillPoints: 0
        };

        let enemy = {
            level: 1,
            attack: 4,
            maxHealth: 80,
            health: 80,
            armor: 0
        };

        let gameInterval;
        const damageTextPool = [];

        function startGame() {
            document.getElementById('menu').style.display = 'none';
            document.getElementById('game-screen').style.display = 'block';
            resetBattle();
            gameLoop();
        }

        function resetBattle() {
            enemy.level = player.level;
            enemy.attack = 4 + Math.floor(player.level * 1.5);
            enemy.maxHealth = 80 + player.level * 20;
            enemy.health = enemy.maxHealth;
            enemy.armor = Math.floor(player.level * 0.5);
            
            updateUI();
        }

        function gameLoop() {
            if (gameInterval) clearInterval(gameInterval);
            gameInterval = setInterval(() => {
                playerAttack();
                if (enemy.health <= 0) endBattle();
                setTimeout(() => {
                    enemyAttack();
                    if (player.health <= 0) endBattle();
                }, 500);
            }, 2000);
        }

        function playerAttack() {
            const damage = Math.max(1, player.attack - enemy.armor);
            enemy.health = Math.max(0, enemy.health - damage);
            showDamageText(damage, 'enemy');
            updateUI();
        }

        function enemyAttack() {
            const damage = Math.max(1, enemy.attack - player.armor);
            player.health = Math.max(0, player.health - damage);
            showDamageText(damage, 'player');
            updateUI();
        }

        function endBattle() {
            clearInterval(gameInterval);
            if (enemy.health <= 0) {
                player.xp += enemy.level * 5;
                checkLevelUp();
            }
            setTimeout(() => {
                document.getElementById('game-screen').style.display = 'none';
                document.getElementById('menu').style.display = 'block';
                resetBattle();
            }, 2000);
        }

        function checkLevelUp() {
            if (player.xp >= player.xpRequired) {
                player.level++;
                player.skillPoints++;
                player.xp = 0;
                player.xpRequired = Math.floor(10 * Math.pow(1.5, player.level));
                alert(`Уровень повышен! Текущий уровень: ${player.level}`);
            }
        }

        function showDamageText(damage, target) {
            const element = document.createElement('div');
            element.className = 'damage-text';
            element.textContent = `-${damage}`;
            element.style.left = target === 'player' ? '100px' : 'calc(100vw - 100px)';
            document.body.appendChild(element);
            setTimeout(() => element.remove(), 1000);
        }

        function updateUI() {
            document.getElementById('player-health-fill').style.width = 
                (player.health / player.maxHealth) * 100 + '%';
            document.getElementById('enemy-health-fill').style.width = 
                (enemy.health / enemy.maxHealth) * 100 + '%';
            
            document.getElementById('status').innerHTML = 
                `Ур. ${player.level} | Опыт: ${player.xp}/${player.xpRequired}<br>
                Здоровье: ${player.health}/${player.maxHealth}`;
        }

        function showUpgrades() {
            document.getElementById('menu').style.display = 'none';
            document.getElementById('upgrade-menu').style.display = 'block';
        }

        function showMenu() {
            document.getElementById('upgrade-menu').style.display = 'none';
            document.getElementById('menu').style.display = 'block';
        }

        function upgrade(stat) {
            if (player.skillPoints <= 0) return;
            player.skillPoints--;
            
            if (stat === 'attack') player.attack += 1;
            if (stat === 'health') player.maxHealth += 10;
            if (stat === 'armor') player.armor += 1;
            
            updateUI();
        }
    </script>
</body>
</html>
