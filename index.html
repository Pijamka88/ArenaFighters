<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Chaos Battle</title>
    <style>
        body { font-family: Arial; margin: 0; padding: 0; background: #1a1a1a; }
        .menu { padding: 20px; text-align: center; }
        .menu button { padding: 10px 20px; margin: 5px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; }
        #gameArea { display: none; padding: 20px; }
        #playerInfo, #enemyInfo { margin: 10px; padding: 10px; background: #2c2c2c; color: white; border-radius: 5px; }
        #log { margin: 10px; padding: 10px; background: #333; color: white; min-height: 100px; overflow-y: auto; }
        .damage { color: red; }
        .heal { color: green; }
        #statsModal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #333; padding: 20px; border-radius: 5px; }
        #statsModal button { margin: 5px; }
    </style>
</head>
<body>
    <div class="menu">
        <button onclick="startGame()">Начать бой</button>
        <button onclick="showStats()">Прокачка</button>
    </div>

    <div id="gameArea">
        <div id="playerInfo">Игрок: Жизни: <span id="playerHealth">100</span> | Броня: <span id="playerArmor">10</span></div>
        <div id="enemyInfo">Бот: Жизни: <span id="enemyHealth">100</span></div>
        <div id="log"></div>
        <button onclick="endBattle()">Завершить бой</button>
    </div>

    <div id="statsModal">
        <h3>Прокачка</h3>
        <button onclick="upgrade('health')">Жизни (+10)</button>
        <button onclick="upgrade('armor')">Броня (+5)</button>
        <button onclick="upgrade('energy')">Энергия (+5)</button>
    </div>

    <script>
        let player = {
            health: 100,
            energy: 50,
            armor: 10,
            level: 1,
            exp: 0,
            points: 0
        };

        let enemy = {
            health: 0,
            attackPower: 0
        };

        let battleInterval;

        function startGame() {
            resetBattle();
            const enemyLevel = Math.floor(Math.random() * 3) + 1;
            enemy.health = 100 + enemyLevel * 10;
            enemy.attackPower = 20 + enemyLevel * 5;
            document.getElementById('enemyInfo').innerHTML = `Бот: Жизни: ${enemy.health}`;
            document.getElementById('gameArea').style.display = 'block';
            document.querySelector('.menu').style.display = 'none';
            battleInterval = setInterval(combatRound, 1000);
        }

        function combatRound() {
            if (player.health <= 0 || enemy.health <= 0) return;

            // Игрок атакует
            const damage = player.energy - enemy.attackPower/2;
            if (damage > 0) {
                enemy.health -= damage;
                logMessage(`Вы нанесли ${damage} урона!`, 'damage');
            } else {
                logMessage('Броня противника поглотила урон!', 'heal');
            }

            // Бот атакует
            const playerDamage = enemy.attackPower - player.armor;
            if (playerDamage > 0) {
                player.health -= playerDamage;
                logMessage(`Противник нанес ${playerDamage} урона!`, 'damage');
            } else {
                logMessage('Ваша броня поглотила атаку!', 'heal');
            }

            updateUI();
        }

        function updateUI() {
            document.getElementById('playerHealth').textContent = player.health;
            document.getElementById('enemyHealth').textContent = enemy.health;
            document.getElementById('playerArmor').textContent = player.armor;
        }

        function logMessage(text, className) {
            const log = document.getElementById('log');
            const entry = document.createElement('div');
            entry.textContent = text;
            if (className) entry.classList.add(className);
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }

        function endBattle() {
            clearInterval(battleInterval);
            if (enemy.health <= 0) {
                logMessage('ПОБЕДА!', 'heal');
                player.exp += 10;
                checkLevelUp();
            } else {
                logMessage('Поражение...', 'damage');
            }
            document.getElementById('gameArea').style.display = 'none';
            document.querySelector('.menu').style.display = 'block';
        }

        function checkLevelUp() {
            const levels = [50, 150, 300, 500]; // Опыт для уровней
            while (player.exp >= levels[player.level-1]) {
                player.level++;
                player.points++;
                logMessage(`Уровень повышен до ${player.level}!`, 'heal');
            }
        }

        function showStats() {
            if (player.points > 0) {
                document.getElementById('statsModal').style.display = 'block';
            } else {
                alert('Нет доступных очков!');
            }
        }

        function upgrade(stat) {
            if (player.points <= 0) return;
            switch(stat) {
                case 'health':
                    player.health += 10;
                    player.points--;
                    break;
                case 'armor':
                    player.armor += 5;
                    player.points--;
                    break;
                case 'energy':
                    player.energy += 5;
                    player.points--;
                    break;
            }
            updateUI();
            document.getElementById('statsModal').style.display = 'none';
        }

        function resetBattle() {
            enemy.health = 0;
            clearInterval(battleInterval);
        }
    </script>
</body>
</html>
