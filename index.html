<!DOCTYPE html>
<html>
<head>
    <title>Chaos Arena</title>
    <style>
        body { font-family: Arial; margin: 0; }
        #game-container { display: flex; height: 100vh; }
        #menu { width: 250px; padding: 20px; background: #f0f0f0; }
        #battle { flex: 1; display: flex; flex-direction: column; padding: 20px; }
        #log { flex: 1; background: #e0e0e0; padding: 10px; overflow-y: auto; }
        #player-panel { padding: 10px; background: #d0e0f0; margin-bottom: 10px; }
        .stat { margin: 5px 0; }
        #skill-panel { display: flex; justify-content: space-around; }
        button { padding: 10px 20px; margin: 5px; }
        .attack { animation: pulse 1s; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
    </style>
</head>
<body>
<div id="game-container">
    <div id="menu">
        <h2>Chaos Arena</h2>
        <button onclick="startBattle()">Начать бой</button>
        <button onclick="showStats()">Статистика</button>
        <button onclick="resetGame()">Новая игра</button>
    </div>
    <div id="battle" style="display: none;">
        <div id="player-panel">
            <div class="stat">Уровень: <span id="level">1</span></div>
            <div class="stat">Опыт: <span id="exp">0/100</span></div>
            <div class="stat">Жизни: <span id="health">100</span></div>
            <div class="stat">Энергия: <span id="energy">50</span></div>
            <div class="stat">Броня: <span id="armor">10</span></div>
            <div class="stat">Очки: <span id="skills">0</span></div>
        </div>
        <div id="log"></div>
        <div id="skill-panel">
            <button onclick="addSkill('health')">Жизни</button>
            <button onclick="addSkill('energy')">Энергия</button>
            <button onclick="addSkill('armor')">Броня</button>
        </div>
    </div>
</div>

<script>
const player = {
    level: 1,
    exp: 0,
    health: 100,
    energy: 50,
    armor: 10,
    skills: 0,
    baseAtk: 20
};

const bots = [
    { level: 1, health: 80, armor: 5, atk: 15 },
    { level: 2, health: 100, armor: 8, atk: 20 },
    { level: 3, health: 120, armor: 10, atk: 25 }
];

let currentBot = null;
let battleActive = false;

function startBattle() {
    const bot = bots[Math.floor(Math.random() * bots.length)];
    currentBot = { ...bot };
    currentBot.health = bot.health;
    currentBot.armor = bot.armor;
    currentBot.atk = bot.atk;
    updateUI();
    document.getElementById('battle').style.display = 'flex';
    document.getElementById('menu').style.display = 'none';
    fight();
}

function fight() {
    if (battleActive) return;
    battleActive = true;
    
    const log = document.getElementById('log');
    log.innerHTML = `Бой с ботом ${currentBot.level} уровня!`;
    
    const fightLoop = setInterval(() => {
        // Игрок атакует
        if (player.energy >= 10) {
            const damage = Math.max(0, player.baseAtk - currentBot.armor);
            currentBot.health -= damage;
            log.innerHTML += `<br><span class="attack">Вы нанесли ${damage} урона!</span>`;
            player.energy -= 10;
            if (currentBot.health <= 0) {
                winBattle();
                clearInterval(fightLoop);
                return;
            }
        }
        
        // Бот атакует
        const botDamage = Math.max(0, currentBot.atk - player.armor);
        player.health -= botDamage;
        log.innerHTML += `<br>Бот нанес ${botDamage} урона!`;
        if (player.health <= 0) {
            log.innerHTML += '<br>Вы проиграли!';
            clearInterval(fightLoop);
            endBattle();
            return;
        }
        
        // Энергия восстанавливается
        player.energy = Math.min(100, player.energy + 5);
        
        updateUI();
    }, 1500);
}

function winBattle() {
    const expGain = currentBot.level * 20;
    player.exp += expGain;
    log.innerHTML += `<br>Победа! Получено ${expGain} опыта`;
    
    while (player.exp >= 100 * player.level) {
        player.level++;
        player.skills++;
        log.innerHTML += `<br>Уровень повышен до ${player.level}!`;
    }
    
    endBattle();
}

function endBattle() {
    battleActive = false;
    document.getElementById('menu').style.display = 'block';
    document.getElementById('battle').style.display = 'none';
    updateUI();
}

function addSkill(stat) {
    if (player.skills > 0) {
        player.skills--;
        switch(stat) {
            case 'health': player.health += 20; break;
            case 'energy': player.energy += 10; break;
            case 'armor': player.armor += 2; break;
        }
        updateUI();
    }
}

function updateUI() {
    document.getElementById('level').textContent = player.level;
    document.getElementById('exp').textContent = `${player.exp}/${100 * player.level}`;
    document.getElementById('health').textContent = player.health;
    document.getElementById('energy').textContent = player.energy;
    document.getElementById('armor').textContent = player.armor;
    document.getElementById('skills').textContent = player.skills;
}

function showStats() {
    alert(`
Уровень: ${player.level}
Опыт: ${player.exp}/${100 * player.level}
Жизни: ${player.health}
Энергия: ${player.energy}
Броня: ${player.armor}
Очки: ${player.skills}
`);
}

function resetGame() {
    player.level = 1;
    player.exp = 0;
    player.health = 100;
    player.energy = 50;
    player.armor = 10;
    player.skills = 0;
    updateUI();
    endBattle();
}
</script>
</body>
</html>
