<!DOCTYPE html>
<html>
<head>
    <title>Medieval Clash</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=MedievalSharp&display=swap" rel="stylesheet">
    <style>
        :root {
            --wood-1: #6B4423;
            --wood-2: #4A2B0F;
            --metal-1: #808080;
            --metal-2: #D4AF37;
            --red-1: #8B0000;
            --text-light: #FFE4C4;
        }

        body {
            margin: 0;
            background: var(--wood-2);
            color: var(--text-light);
            font-family: 'MedievalSharp', cursive;
            text-align: center;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            background-image: 
                linear-gradient(rgba(0,0,0,0.5), 
                url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAM1BMVEWNjY2Pj4+SkpKQkJCUlJSRkZGTk5OSkpKRkZGTk5OSkpKRkZGUlJSSkpKRkZGTk5OSkpJ0dXhZAAAAEHRSTlMAECAwQFBgcICPn6+/z9/vkqJP8wAAAY1JREFUWMPtl9sSgyAMRGkUBfz/X24VtNp2Z9ruvNCT6QkPh0BCVJ3Yl2Hw1wU8Hv/4gH3fTdO0bRvHcZ7nZVnWdV3XdX+UQghCiGVZtm3btu04juM4juO4ruu6ruv6E1JKKaWcc0oppZRzzjnnnHPOOeecc36FlFJrrbXWWmuttdZaa6211lprrbXWWn+FlFJrrbXWWmuttdZaa6211lprrbXWWn+FlFJrrbXWWmuttdZaa6211lprrbXWWn+FlFJrrbXWWmuttdZaa6211lprrbXWWn+FlFJrrbXWWmuttdZaa6211lprrbXWWn+FlFJrrbXWWmuttdZaa6211lprrbXWWn+FlFJrrbXWWmuttdZaa6211lprrbXWWn+FlFJrrbXWWmuttdZaa6211lprrbXWWn+FlFJrrbXWWmuttdZaa6211lprrbXWWn+FlFJrrbXWWmuttdZaa6211lprrbXWWn+FlFJrrbXWWmuttdZaa6211lprrbXWWn+FlFJrrbXWWmuttdZaa6211lprrbXWWn+FlFJrrbXWWmuttdZaa6211lprrbXWWn+FlFJrrbXWWmsf8A1+BQ8T5UJjBwAAAABJRU5ErkJggg==');
        }

        #mainMenu, #arena {
            padding: 2rem;
            max-width: 800px;
            margin: 2rem auto;
            background: var(--wood-1);
            border: 3px solid var(--metal-2);
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }

        .button {
            background: var(--metal-1);
            border: 2px solid var(--metal-2);
            color: var(--text-light);
            padding: 1rem 2rem;
            margin: 1rem;
            cursor: pointer;
            font-size: 1.2rem;
            text-transform: uppercase;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .button:hover {
            background: var(--metal-2);
            transform: scale(1.05);
        }

        .character {
            width: 150px;
            height: 150px;
            margin: 2rem auto;
            background-size: contain;
            background-repeat: no-repeat;
            filter: drop-shadow(0 0 10px rgba(0,0,0,0.5));
        }

        .health-bar {
            width: 100%;
            height: 30px;
            background: var(--wood-2);
            border: 2px solid var(--metal-2);
            margin: 1rem 0;
            position: relative;
        }

        .health-fill {
            height: 100%;
            background: var(--red-1);
            transition: width 0.3s;
            position: relative;
        }

        .health-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(transparent 50%, rgba(0,0,0,0.2) 50%);
        }

        #battleLog {
            height: 150px;
            overflow-y: auto;
            background: rgba(0,0,0,0.7);
            padding: 1rem;
            margin: 1rem 0;
            border: 2px solid var(--metal-2);
            text-align: left;
        }

        .modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--wood-1);
            padding: 2rem;
            border: 3px solid var(--metal-2);
            z-index: 1000;
            max-width: 500px;
        }

        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            z-index: 999;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            padding: 1rem;
            background: rgba(0,0,0,0.5);
            border: 2px solid var(--metal-2);
            margin: 1rem 0;
        }

        @keyframes attack {
            0% { transform: translateX(0); }
            50% { transform: translateX(50px); }
            100% { transform: translateX(0); }
        }

        @keyframes hit {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .attack-animation {
            animation: attack 0.3s ease-in-out;
        }

        .hit-animation {
            animation: hit 0.3s ease-in-out;
        }

        .icon {
            width: 32px;
            height: 32px;
            vertical-align: middle;
            margin-right: 0.5rem;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div id="mainMenu">
        <h1>‚öîÔ∏è Medieval Clash üõ°Ô∏è</h1>
        <div class="stats">
            <div>Level: <span id="level">1</span></div>
            <div>XP: <span id="xp">0</span>/100</div>
            <div>Gold: <span id="coins">0</span></div>
            <div>Attack: <span id="attack">10</span></div>
            <div>Defense: <span id="defense">0</span></div>
            <div>Health: <span id="maxHealth">100</span></div>
        </div>
        <button class="button" onclick="startGame()">Start Battle</button>
        <button class="button" onclick="showSmithy()">Blacksmith</button>
    </div>

    <div id="arena" class="hidden">
        <div id="playerArea">
            <div class="health-bar">
                <div id="playerHealth" class="health-fill" style="width: 100%"></div>
            </div>
            <div class="character" id="playerIcon" style="background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZmlsbD0iI2ZmZiIgZD0iTTEyIDJjLTMuOSAwLTcgMy4xLTcgN3MzLjEgNyA3IDcgNy0zLjEgNy03LTMuMS03LTctN3ptMCAyYzIuOCAwIDUgMi4yIDUgNXMtMi4yIDUtNSA1LTUtMi4yLTUtNSAyLjItNSA1LTV6Ii8+PHBhdGggZmlsbD0iI2ZmZiIgZD0iTTEyIDEwbC0yIDJoNHoiLz48L3N2Zz4=')"></div>
        </div>
        
        <div id="enemyArea">
            <div class="health-bar">
                <div id="enemyHealth" class="health-fill" style="width: 100%"></div>
            </div>
            <div class="character" id="enemyIcon" style="background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZmlsbD0iI2ZmZiIgZD0iTTEyIDJjLTMuOSAwLTcgMy4xLTcgN3MzLjEgNyA3IDcgNy0zLjEgNy03LTMuMS03LTctN3ptMCAyYzIuOCAwIDUgMi4yIDUgNXMtMi4yIDUtNSA1LTUtMi4yLTUtNSAyLjItNSA1LTV6Ii8+PHBhdGggZmlsbD0iI2ZmZiIgZD0iTTEwIDEwaDR2NGgtNHoiLz48L3N2Zz4=')"></div>
        </div>

        <div id="battleLog"></div>
        <div>
            <button class="button hidden" id="continueBtn" onclick="startGame()">Continue</button>
            <button class="button" onclick="returnToMenu()">Retreat</button>
        </div>
    </div>

    <div id="smithyModal" class="hidden modal">
        <h2>‚öíÔ∏è Blacksmith</h2>
        <button class="button" onclick="upgrade('attack')">
            <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZmlsbD0iI0Q0QUYzNyIgZD0iTTE0LjggMmwtMyAzIDIuOCAyLjgtNS4xIDUuMS0xLjQtMS40LTIuOCAyLjggMS40IDEuNEwzIDE5Ljh2Mi4ybDQuNC00LjQgMS40IDEuNCAyLjgtMi44LTEuNC0xLjQgNS4xLTUuMSAyLjggMi44IDMtMy02LjgtNi44ek0xMS42IDE4LjJsLTEuNC0xLjQgMi44LTIuOCAxLjQgMS40LTIuOCAyLjh6Ii8+PC9zdmc+" class="icon">
            Sharpen Sword (+5)
            <div class="cost">50 Gold</div>
        </button>
        <button class="button" onclick="upgrade('health')">
            <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZmlsbD0iI0Q0QUYzNyIgZD0iTTEyIDJjMy45IDAgNyAzLjEgNyA3IDAgMi40LTEuMiA0LjUtMyA1LjdWMjJINXYtNy4zQzYuMiAxMy41IDUgMTEuNCA1IDljMC0zLjkgMy4xLTcgNy03em0wIDJjLTIuOCAwLTUgMi4yLTUgNSAwIDEuOSAxLjEgMy42IDIuNyA0LjRsLjMuMlYyMGg0di02LjRsLjMtLjJjMS42LS44IDIuNy0yLjUgMi43LTQuNCAwLTIuOC0yLjItNS01LTV6Ii8+PC9zdmc+" class="icon">
            Reinforce Armor (+20)
            <div class="cost">50 Gold</div>
        </button>
        <button class="button" onclick="hideSmithy()">Exit</button>
    </div>
    <div id="modalBackdrop" class="hidden modal-backdrop"></div>

    <script>
        let player = {
            level: 1,
            xp: 0,
            coins: 0,
            attack: 10,
            defense: 0,
            health: 100,
            maxHealth: 100,
            wins: 0
        };

        let currentEnemy = null;
        let battleInterval = null;

        function createEnemy(isBoss = false) {
            const baseHealth = isBoss ? 300 : 80 + player.wins * 20;
            return {
                name: isBoss ? 'Dragon' : ['Orc', 'Troll', 'Goblin'][Math.floor(Math.random()*3)],
                health: baseHealth,
                maxHealth: baseHealth,
                attack: 15 + player.wins * 3,
                defense: 5 + player.wins
            };
        }

        function startGame() {
            document.getElementById('mainMenu').classList.add('hidden');
            document.getElementById('arena').classList.remove('hidden');
            document.getElementById('continueBtn').classList.add('hidden');
            
            player.health = player.maxHealth;
            currentEnemy = createEnemy(player.wins >= 5);
            
            if(player.wins >= 5) {
                logBattle('DRAGON APPEARS!');
                player.wins = 0;
            }

            updateHealthBars();
            battleInterval = setInterval(fightRound, 1500);
        }

        function fightRound() {
            // Player attack
            const playerDamage = Math.max(0, player.attack - currentEnemy.defense);
            currentEnemy.health -= playerDamage;
            document.getElementById('enemyIcon').classList.add('attack-animation');
            logBattle(`You hit for ${playerDamage} damage!`);

            // Enemy attack
            const enemyDamage = Math.max(0, currentEnemy.attack - player.defense);
            player.health -= enemyDamage;
            document.getElementById('playerIcon').classList.add('hit-animation');
            logBattle(`${currentEnemy.name} hits for ${enemyDamage} damage!`);

            // Reset animations
            setTimeout(() => {
                document.getElementById('enemyIcon').classList.remove('attack-animation');
                document.getElementById('playerIcon').classList.remove('hit-animation');
            }, 300);

            updateHealthBars();

            if(currentEnemy.health <= 0) endBattle(true);
            else if(player.health <= 0) endBattle(false);
        }

        function endBattle(victory) {
            clearInterval(battleInterval);
            if(victory) {
                player.wins++;
                player.xp += 25;
                player.coins += 10;
                logBattle('Victory! +25 XP +10 Gold');
                
                if(player.xp >= 100) {
                    player.level++;
                    player.attack += 5;
                    player.maxHealth += 20;
                    player.xp = 0;
                    logBattle('Level Up! +5 Attack +20 Health');
                }
                
                document.getElementById('continueBtn').classList.remove('hidden');
            } else {
                logBattle('Defeat...');
                player.wins = 0;
            }
            
            updateStats();
            saveGame();
        }

        function upgrade(stat) {
            const cost = 50;
            if(player.coins >= cost) {
                player.coins -= cost;
                if(stat === 'attack') player.attack += 5;
                if(stat === 'health') player.maxHealth += 20;
                updateStats();
                saveGame();
                hideSmithy();
            }
        }

        function updateHealthBars() {
            const playerPercent = Math.max(0, (player.health / player.maxHealth) * 100;
            const enemyPercent = Math.max(0, (currentEnemy.health / currentEnemy.maxHealth) * 100;
            
            document.getElementById('playerHealth').style.width = `${playerPercent}%`;
            document.getElementById('enemyHealth').style.width = `${enemyPercent}%`;
        }

        function updateStats() {
            document.getElementById('level').textContent = player.level;
            document.getElementById('xp').textContent = player.xp;
            document.getElementById('coins').textContent = player.coins;
            document.getElementById('attack').textContent = player.attack;
            document.getElementById('defense').textContent = player.defense;
            document.getElementById('maxHealth').textContent = player.maxHealth;
        }

        function logBattle(text) {
            const log = document.getElementById('battleLog');
            const entry = document.createElement('div');
            entry.textContent = text;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }

        function showSmithy() {
            document.getElementById('smithyModal').classList.remove('hidden');
            document.getElementById('modalBackdrop').classList.remove('hidden');
        }

        function hideSmithy() {
            document.getElementById('smithyModal').classList.add('hidden');
            document.getElementById('modalBackdrop').classList.add('hidden');
        }

        function returnToMenu() {
            document.getElementById('mainMenu').classList.remove('hidden');
            document.getElementById('arena').classList.add('hidden');
            clearInterval(battleInterval);
        }

        function saveGame() {
            localStorage.setItem('medievalClashSave', JSON.stringify(player));
        }

        function loadGame() {
            const saved = localStorage.getItem('medievalClashSave');
            if(saved) player = JSON.parse(saved);
            updateStats();
        }

        // Initialize game
        window.onload = loadGame;
    </script>
</body>
</html>