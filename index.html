<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Arena Chaos</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@400;500&display=swap">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            touch-action: manipulation;
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
        }
        
        .game-container {
            width: 100%;
            max-width: 500px;
            height: 100vh;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        /* Главное меню */
        .screen {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            padding: 20px;
            text-align: center;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 10;
            background: rgba(10, 15, 30, 0.95);
        }
        
        #main-menu {
            display: flex;
        }
        
        .logo {
            font-family: 'Orbitron', sans-serif;
            font-size: 3.5rem;
            margin-bottom: 40px;
            text-shadow: 0 0 10px #00eeff, 0 0 20px #00eeff;
            letter-spacing: 3px;
            background: linear-gradient(to right, #00eeff, #00c3ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .menu-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 80%;
            max-width: 300px;
        }
        
        .btn {
            background: linear-gradient(135deg, #00c3ff, #0072ff);
            border: none;
            border-radius: 50px;
            color: white;
            padding: 15px 25px;
            font-size: 1.1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 114, 255, 0.3);
            font-family: 'Roboto', sans-serif;
        }
        
        .btn:hover, .btn:active {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 114, 255, 0.5);
        }
        
        .btn:active {
            transform: translateY(1px);
        }
        
        .btn-ability {
            background: linear-gradient(135deg, #ff416c, #ff4b2b);
            margin-top: 10px;
        }
        
        /* Игровой экран */
        #game-screen {
            display: none;
            flex-direction: column;
            height: 100%;
            padding: 20px;
        }
        
        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            width: 100%;
        }
        
        .player-info {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .level-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .level {
            background: #ff9800;
            color: #000;
            font-weight: bold;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
        }
        
        .exp-bar {
            width: 150px;
            height: 12px;
            background: #333;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .exp-fill {
            height: 100%;
            background: linear-gradient(to right, #00c3ff, #0072ff);
            border-radius: 10px;
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .game-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            margin: 20px 0;
        }
        
        .arena {
            width: 100%;
            height: 250px;
            background: rgba(0, 0, 0, 0.3);
            border: 3px solid #00eeff;
            border-radius: 10px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0, 238, 255, 0.3);
        }
        
        .player-character, .enemy-character {
            position: absolute;
            width: 80px;
            height: 80px;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: transform 0.2s;
        }
        
        .player-character {
            left: 20%;
            bottom: 30px;
            background: linear-gradient(135deg, #0072ff, #00c3ff);
            clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
        }
        
        .enemy-character {
            right: 20%;
            bottom: 30px;
            background: linear-gradient(135deg, #ff416c, #ff4b2b);
            clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
        }
        
        .health-bar {
            position: absolute;
            width: 80%;
            height: 20px;
            background: #333;
            border-radius: 10px;
            overflow: hidden;
            top: 20px;
        }
        
        .health-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.3s ease;
        }
        
        .player-health .health-fill {
            background: linear-gradient(to right, #4CAF50, #8BC34A);
            width: 100%;
        }
        
        .enemy-health .health-fill {
            background: linear-gradient(to right, #f44336, #ff9800);
            width: 100%;
        }
        
        .player-health {
            left: 10%;
        }
        
        .enemy-health {
            right: 10%;
        }
        
        .health-label {
            position: absolute;
            top: -25px;
            font-size: 0.9rem;
            font-weight: bold;
        }
        
        .player-health .health-label {
            left: 0;
            color: #00eeff;
        }
        
        .enemy-health .health-label {
            right: 0;
            color: #ff416c;
        }
        
        .combat-text {
            position: absolute;
            font-size: 1.2rem;
            font-weight: bold;
            animation: floatUp 1s forwards;
            pointer-events: none;
            z-index: 5;
        }
        
        @keyframes floatUp {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-50px); opacity: 0; }
        }
        
        .player-damage {
            color: #ff416c;
        }
        
        .enemy-damage {
            color: #00eeff;
        }
        
        .ability-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 20px;
            width: 100%;
        }
        
        .ability-btn {
            width: 80%;
            max-width: 300px;
            height: 60px;
            font-size: 1.2rem;
            font-weight: bold;
            background: linear-gradient(135deg, #ff9800, #ff5722);
            border: 3px solid #ffd600;
            box-shadow: 0 0 15px rgba(255, 152, 0, 0.5);
        }
        
        .cooldown-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            font-weight: bold;
            border-radius: 50px;
            opacity: 0;
            pointer-events: none;
        }
        
        /* Экран победы/поражения */
        .result-screen {
            background: rgba(10, 15, 30, 0.95);
            z-index: 20;
        }
        
        .result-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }
        
        .result-title {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 10px;
            font-family: 'Orbitron', sans-serif;
        }
        
        .victory {
            color: #4CAF50;
            text-shadow: 0 0 10px rgba(76, 175, 80, 0.7);
        }
        
        .defeat {
            color: #f44336;
            text-shadow: 0 0 10px rgba(244, 67, 54, 0.7);
        }
        
        .reward-info {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin: 10px 0;
        }
        
        /* Анимации */
        @keyframes attackAnimation {
            0% { transform: translateX(0); }
            50% { transform: translateX(30px); }
            100% { transform: translateX(0); }
        }
        
        @keyframes enemyAttackAnimation {
            0% { transform: translateX(0); }
            50% { transform: translateX(-30px); }
            100% { transform: translateX(0); }
        }
        
        @keyframes abilityAnimation {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 152, 0, 0.7); }
            70% { transform: scale(1.1); box-shadow: 0 0 0 15px rgba(255, 152, 0, 0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 152, 0, 0); }
        }
        
        .attack {
            animation: attackAnimation 0.3s ease;
        }
        
        .enemy-attack {
            animation: enemyAttackAnimation 0.3s ease;
        }
        
        .ability-active {
            animation: abilityAnimation 0.5s ease;
        }
        
        /* Мобильная оптимизация */
        @media (max-width: 480px) {
            .logo {
                font-size: 2.5rem;
            }
            
            .btn {
                padding: 12px 20px;
                font-size: 1rem;
            }
            
            .game-area {
                margin: 10px 0;
            }
            
            .arena {
                height: 200px;
            }
            
            .player-character, .enemy-character {
                width: 60px;
                height: 60px;
            }
            
            .ability-btn {
                height: 50px;
                font-size: 1rem;
            }
            
            .result-title {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- Главное меню -->
        <div id="main-menu" class="screen">
            <div class="logo">ARENA CHAOS</div>
            <div class="menu-buttons">
                <button id="start-btn" class="btn">Начать игру</button>
                <button id="how-to-play-btn" class="btn">Как играть</button>
                <button id="credits-btn" class="btn">Разработчики</button>
            </div>
        </div>
        
        <!-- Экран "Как играть" -->
        <div id="how-to-play" class="screen">
            <h2>Как играть</h2>
            <div class="instruction">
                <p>⚔️ В игре Arena Chaos бои проходят автоматически.</p>
                <p>🔥 Ваш персонаж сражается с врагами, которые становятся сильнее с каждым уровнем.</p>
                <p>💥 Ваша задача - вовремя использовать специальную способность, нажав на кнопку внизу экрана.</p>
                <p>🌟 За победу вы получаете опыт и повышаете уровень, становясь сильнее.</p>
                <p>🏆 Пройдите как можно больше уровней!</p>
            </div>
            <button id="back-from-instructions" class="btn">Назад</button>
        </div>
        
        <!-- Экран "Разработчики" -->
        <div id="credits" class="screen">
            <h2>Разработчики</h2>
            <div class="credits-info">
                <p>Игра "Arena Chaos" создана для Telegram Web App</p>
                <p>Версия: 1.0</p>
                <p>Оптимизировано для мобильных устройств</p>
                <p>Разработано: 2023</p>
            </div>
            <button id="back-from-credits" class="btn">Назад</button>
        </div>
        
        <!-- Игровой экран -->
        <div id="game-screen" class="screen">
            <div class="top-bar">
                <div class="player-info">
                    <div class="level-container">
                        <span>Уровень:</span>
                        <div class="level">1</div>
                    </div>
                    <div class="exp-bar">
                        <div class="exp-fill"></div>
                    </div>
                </div>
                <div class="wave-info">
                    <div class="level-container">
                        <span>Волна:</span>
                        <div class="level enemy-level">1</div>
                    </div>
                </div>
            </div>
            
            <div class="game-area">
                <div class="arena">
                    <!-- Полоски здоровья -->
                    <div class="health-bar player-health">
                        <div class="health-fill"></div>
                        <div class="health-label">Игрок</div>
                    </div>
                    <div class="health-bar enemy-health">
                        <div class="health-fill"></div>
                        <div class="health-label">Враг</div>
                    </div>
                    
                    <!-- Персонажи -->
                    <div class="player-character">
                        <span class="character-icon">⚔️</span>
                    </div>
                    <div class="enemy-character">
                        <span class="character-icon">👹</span>
                    </div>
                </div>
                
                <div class="ability-container">
                    <button id="ability-btn" class="btn btn-ability ability-btn">
                        Огненный шар
                        <div class="cooldown-overlay"></div>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Экран победы -->
        <div id="victory-screen" class="screen result-screen">
            <div class="result-content">
                <div class="result-title victory">ПОБЕДА!</div>
                <div class="reward-info">
                    <p>Вы победили врага!</p>
                    <p class="exp-reward">+100 опыта</p>
                </div>
                <button id="next-level-btn" class="btn">Следующий уровень</button>
                <button id="to-menu-from-victory" class="btn">В меню</button>
            </div>
        </div>
        
        <!-- Экран поражения -->
        <div id="defeat-screen" class="screen result-screen">
            <div class="result-content">
                <div class="result-title defeat">ПОРАЖЕНИЕ!</div>
                <div class="reward-info">
                    <p>Вы достигли уровня: <span class="reached-level">1</span></p>
                    <p>Ваш рекорд: <span class="high-score">1</span></p>
                </div>
                <button id="restart-btn" class="btn">Играть снова</button>
                <button id="to-menu-from-defeat" class="btn">В меню</button>
            </div>
        </div>
    </div>

    <script>
        // Состояние игры
        const gameState = {
            playerLevel: 1,
            playerExp: 0,
            expToNextLevel: 100,
            playerHealth: 100,
            playerMaxHealth: 100,
            playerDamage: 10,
            currentWave: 1,
            enemyHealth: 50,
            enemyMaxHealth: 50,
            enemyDamage: 5,
            abilityCooldown: 0,
            abilityDamage: 30,
            gameActive: false,
            highScore: 0
        };

        // Элементы интерфейса
        const elements = {
            mainMenu: document.getElementById('main-menu'),
            howToPlay: document.getElementById('how-to-play'),
            credits: document.getElementById('credits'),
            gameScreen: document.getElementById('game-screen'),
            victoryScreen: document.getElementById('victory-screen'),
            defeatScreen: document.getElementById('defeat-screen'),
            
            startBtn: document.getElementById('start-btn'),
            howToPlayBtn: document.getElementById('how-to-play-btn'),
            creditsBtn: document.getElementById('credits-btn'),
            backFromInstructions: document.getElementById('back-from-instructions'),
            backFromCredits: document.getElementById('back-from-credits'),
            abilityBtn: document.getElementById('ability-btn'),
            nextLevelBtn: document.getElementById('next-level-btn'),
            toMenuFromVictory: document.getElementById('to-menu-from-victory'),
            restartBtn: document.getElementById('restart-btn'),
            toMenuFromDefeat: document.getElementById('to-menu-from-defeat'),
            
            playerLevel: document.querySelector('.player-info .level'),
            expFill: document.querySelector('.exp-fill'),
            enemyLevel: document.querySelector('.enemy-level'),
            playerHealthFill: document.querySelector('.player-health .health-fill'),
            enemyHealthFill: document.querySelector('.enemy-health .health-fill'),
            playerCharacter: document.querySelector('.player-character'),
            enemyCharacter: document.querySelector('.enemy-character'),
            cooldownOverlay: document.querySelector('.cooldown-overlay'),
            
            expReward: document.querySelector('.exp-reward'),
            reachedLevel: document.querySelector('.reached-level'),
            highScoreElement: document.querySelector('.high-score')
        };

        // Настройка обработчиков событий
        function setupEventListeners() {
            // Навигация по меню
            elements.startBtn.addEventListener('click', startGame);
            elements.howToPlayBtn.addEventListener('click', () => showScreen('how-to-play'));
            elements.creditsBtn.addEventListener('click', () => showScreen('credits'));
            elements.backFromInstructions.addEventListener('click', () => showScreen('main-menu'));
            elements.backFromCredits.addEventListener('click', () => showScreen('main-menu'));
            
            // Игровые действия
            elements.abilityBtn.addEventListener('click', useAbility);
            elements.nextLevelBtn.addEventListener('click', nextLevel);
            elements.toMenuFromVictory.addEventListener('click', returnToMenu);
            elements.restartBtn.addEventListener('click', restartGame);
            elements.toMenuFromDefeat.addEventListener('click', returnToMenu);
        }

        // Показать экран
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.style.display = 'none';
            });
            document.getElementById(screenId).style.display = 'flex';
        }

        // Начать игру
        function startGame() {
            resetGameState();
            showScreen('game-screen');
            updateUI();
            startCombat();
        }

        // Сброс состояния игры
        function resetGameState() {
            gameState.playerLevel = 1;
            gameState.playerExp = 0;
            gameState.expToNextLevel = 100;
            gameState.playerHealth = 100;
            gameState.playerMaxHealth = 100;
            gameState.playerDamage = 10;
            gameState.currentWave = 1;
            gameState.enemyHealth = 50;
            gameState.enemyMaxHealth = 50;
            gameState.enemyDamage = 5;
            gameState.abilityCooldown = 0;
            gameState.gameActive = true;
            
            elements.abilityBtn.disabled = false;
            elements.cooldownOverlay.style.opacity = '0';
        }

        // Обновление интерфейса
        function updateUI() {
            // Обновление информации игрока
            elements.playerLevel.textContent = gameState.playerLevel;
            elements.expFill.style.width = `${(gameState.playerExp / gameState.expToNextLevel) * 100}%`;
            
            // Обновление информации врага
            elements.enemyLevel.textContent = gameState.currentWave;
            
            // Обновление здоровья
            elements.playerHealthFill.style.width = `${(gameState.playerHealth / gameState.playerMaxHealth) * 100}%`;
            elements.enemyHealthFill.style.width = `${(gameState.enemyHealth / gameState.enemyMaxHealth) * 100}%`;
            
            // Обновление кнопки способности
            if (gameState.abilityCooldown > 0) {
                elements.abilityBtn.disabled = true;
                elements.cooldownOverlay.textContent = gameState.abilityCooldown;
                elements.cooldownOverlay.style.opacity = '1';
            } else {
                elements.abilityBtn.disabled = false;
                elements.cooldownOverlay.style.opacity = '0';
            }
        }

        // Начать бой
        function startCombat() {
            if (!gameState.gameActive) return;
            
            // Автоматическая атака игрока
            setTimeout(() => {
                if (!gameState.gameActive) return;
                
                // Анимация атаки игрока
                elements.playerCharacter.classList.add('attack');
                setTimeout(() => {
                    elements.playerCharacter.classList.remove('attack');
                }, 300);
                
                // Нанесение урона врагу
                const damage = Math.floor(gameState.playerDamage * (0.8 + Math.random() * 0.4));
                gameState.enemyHealth -= damage;
                if (gameState.enemyHealth < 0) gameState.enemyHealth = 0;
                
                // Создание текста урона
                createDamageText(elements.enemyCharacter, damage, 'player-damage');
                updateUI();
                
                // Проверка на победу
                if (gameState.enemyHealth <= 0) {
                    playerWin();
                    return;
                }
                
                // Атака врага
                setTimeout(() => {
                    if (!gameState.gameActive) return;
                    
                    // Анимация атаки врага
                    elements.enemyCharacter.classList.add('enemy-attack');
                    setTimeout(() => {
                        elements.enemyCharacter.classList.remove('enemy-attack');
                    }, 300);
                    
                    // Нанесение урона игроку
                    const enemyDamage = Math.floor(gameState.enemyDamage * (0.8 + Math.random() * 0.4));
                    gameState.playerHealth -= enemyDamage;
                    if (gameState.playerHealth < 0) gameState.playerHealth = 0;
                    
                    // Создание текста урона
                    createDamageText(elements.playerCharacter, enemyDamage, 'enemy-damage');
                    updateUI();
                    
                    // Проверка на поражение
                    if (gameState.playerHealth <= 0) {
                        playerLose();
                        return;
                    }
                    
                    // Продолжение боя
                    startCombat();
                }, 500);
            }, 1000);
        }

        // Создание текста урона
        function createDamageText(target, damage, className) {
            const damageText = document.createElement('div');
            damageText.classList.add('combat-text', className);
            damageText.textContent = `-${damage}`;
            damageText.style.left = `${target.offsetLeft + target.offsetWidth / 2}px`;
            damageText.style.top = `${target.offsetTop}px`;
            document.querySelector('.arena').appendChild(damageText);
            
            // Удаление текста после анимации
            setTimeout(() => {
                damageText.remove();
            }, 1000);
        }

        // Использовать способность
        function useAbility() {
            if (gameState.abilityCooldown > 0 || !gameState.gameActive) return;
            
            // Анимация способности
            elements.abilityBtn.classList.add('ability-active');
            setTimeout(() => {
                elements.abilityBtn.classList.remove('ability-active');
            }, 500);
            
            // Нанесение урона способностью
            const damage = Math.floor(gameState.abilityDamage * (0.9 + Math.random() * 0.2));
            gameState.enemyHealth -= damage;
            if (gameState.enemyHealth < 0) gameState.enemyHealth = 0;
            
            // Создание текста урона
            createDamageText(elements.enemyCharacter, damage, 'player-damage');
            createDamageText(elements.enemyCharacter, '🔥', 'player-damage');
            
            // Установка перезарядки
            gameState.abilityCooldown = 3;
            updateUI();
            
            // Проверка на победу
            if (gameState.enemyHealth <= 0) {
                playerWin();
                return;
            }
            
            // Обновление перезарядки
            const cooldownInterval = setInterval(() => {
                if (!gameState.gameActive) {
                    clearInterval(cooldownInterval);
                    return;
                }
                
                gameState.abilityCooldown--;
                updateUI();
                
                if (gameState.abilityCooldown <= 0) {
                    clearInterval(cooldownInterval);
                }
            }, 1000);
        }

        // Игрок победил
        function playerWin() {
            gameState.gameActive = false;
            
            // Награда за победу
            const expReward = 50 + gameState.currentWave * 10;
            gameState.playerExp += expReward;
            elements.expReward.textContent = `+${expReward} опыта`;
            
            // Проверка повышения уровня
            if (gameState.playerExp >= gameState.expToNextLevel) {
                levelUp();
            }
            
            setTimeout(() => {
                showScreen('victory-screen');
            }, 1500);
        }

        // Повышение уровня
        function levelUp() {
            gameState.playerLevel++;
            gameState.playerExp = gameState.playerExp - gameState.expToNextLevel;
            gameState.expToNextLevel = Math.floor(gameState.expToNextLevel * 1.5);
            
            // Улучшение характеристик
            gameState.playerMaxHealth = Math.floor(gameState.playerMaxHealth * 1.2);
            gameState.playerHealth = gameState.playerMaxHealth;
            gameState.playerDamage = Math.floor(gameState.playerDamage * 1.15);
        }

        // Переход на следующий уровень
        function nextLevel() {
            gameState.currentWave++;
            
            // Усиление врага
            gameState.enemyMaxHealth = Math.floor(50 + gameState.currentWave * 20);
            gameState.enemyHealth = gameState.enemyMaxHealth;
            gameState.enemyDamage = Math.floor(5 + gameState.currentWave * 2);
            
            gameState.gameActive = true;
            showScreen('game-screen');
            updateUI();
            startCombat();
        }

        // Игрок проиграл
        function playerLose() {
            gameState.gameActive = false;
            
            // Обновление рекорда
            if (gameState.currentWave > gameState.highScore) {
                gameState.highScore = gameState.currentWave;
            }
            
            elements.reachedLevel.textContent = gameState.currentWave;
            elements.highScoreElement.textContent = gameState.highScore;
            
            setTimeout(() => {
                showScreen('defeat-screen');
            }, 1500);
        }

        // Перезапуск игры
        function restartGame() {
            resetGameState();
            showScreen('game-screen');
            updateUI();
            startCombat();
        }

        // Вернуться в меню
        function returnToMenu() {
            showScreen('main-menu');
        }

        // Инициализация игры
        function initGame() {
            setupEventListeners();
            showScreen('main-menu');
        }

        // Запуск игры при загрузке страницы
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>