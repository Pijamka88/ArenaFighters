<!DOCTYPE html>
<html>
<head>
    <title>Chaos Arena</title>
    <style>
        body { font-family: Arial; margin: 0; padding: 0; }
        #menu { position: fixed; top: 10px; right: 10px; }
        #arena { width: 600px; height: 400px; background: #f0f0f0; margin: 20px auto; }
        #battleCanvas { width: 100%; height: 100%; }
        #interface { position: fixed; bottom: 10px; left: 10px; }
        .progress-bar { height: 20px; background: #ddd; border-radius: 5px; }
        .progress-bar div { height: 100%; background: #4CAF50; transition: width 0.3s; }
    </style>
</head>
<body>
    <div id="menu">
        <button onclick="startBattle()">Начать бой</button>
        <button onclick="showStats()">Характеристики</button>
    </div>

    <div id="arena">
        <canvas id="battleCanvas" width="600" height="400"></canvas>
    </div>

    <div id="interface">
        <div id="healthBars">
            <div class="progress-bar">
                <div id="playerHP" style="width: 100%"></div>
            </div>
            <div class="progress-bar">
                <div id="enemyHP" style="width: 100%"></div>
            </div>
        </div>
        <div id="battleInfo">
            <p>Уровень: <span id="playerLevel">1</span></p>
            <p>Опыт: <span id="exp">0</span></p>
            <p>Ход боя: <span id="turn">0</span></p>
        </div>
    </div>

    <script>
        class Character {
            constructor(name, level, maxHP, attack, defense, energy) {
                this.name = name
                this.level = level
                this.maxHP = maxHP
                this.currentHP = maxHP
                this.attack = attack
                this.defense = defense
                this.energy = energy
            }
        }

        let player = new Character("Герой", 1, 100, 10, 5, 100)
        let currentEnemy
        let isBattleActive = false
        let turnCount = 0
        const canvas = document.getElementById('battleCanvas')
        const ctx = canvas.getContext('2d')

        function startBattle() {
            if (isBattleActive) return
            currentEnemy = new Character("Бот", player.level, 80 + player.level*10, 8 + player.level*2, 4 + player.level, 80)
            isBattleActive = true
            turnCount = 0
            updateUI()
            battleLoop()
        }

        function battleLoop() {
            if (!isBattleActive) return
            turnCount++
            
            // Игрок атакует
            const damage = Math.max(player.attack - currentEnemy.defense, 0)
            currentEnemy.currentHP -= damage
            drawAttackAnimation(100, 200, damage)
            
            // Проверка победы
            if (currentEnemy.currentHP <= 0) {
                endBattle(true)
                return
            }

            // Бот атакует
            const enemyDamage = Math.max(currentEnemy.attack - player.defense, 0)
            player.currentHP -= enemyDamage
            drawAttackAnimation(400, 200, enemyDamage)
            
            // Проверка поражения
            if (player.currentHP <= 0) {
                endBattle(false)
                return
            }

            updateUI()
            setTimeout(battleLoop, 1000)
        }

        function endBattle(won) {
            isBattleActive = false
            if (won) {
                player.exp += 50 + player.level*10
                if (player.exp >= 100) {
                    player.level++
                    player.exp -= 100
                }
            }
            currentEnemy = null
            updateUI()
        }

        function updateUI() {
            document.getElementById('playerHP').style.width = (player.currentHP/player.maxHP)*100 + '%'
            document.getElementById('enemyHP').style.width = (currentEnemy?.currentHP/currentEnemy?.maxHP || 100)*100 + '%'
            document.getElementById('playerLevel').innerText = player.level
            document.getElementById('exp').innerText = player.exp
            document.getElementById('turn').innerText = turnCount
        }

        function drawAttackAnimation(x, y, damage) {
            ctx.fillStyle = '#ff0000';
            ctx.beginPath();
            ctx.arc(x, y, 20, 0, Math.PI*2);
            ctx.fill();
            setTimeout(() => ctx.clearRect(x-25, y-25, 50, 50), 200);
        }

        function showStats() {
            alert(`
                Уровень: ${player.level}
                Здоровье: ${player.currentHP}/${player.maxHP}
                Атака: ${player.attack}
                Защита: ${player.defense}
                Энергия: ${player.energy}
                Опыт: ${player.exp}
            `)
        }
    </script>
</body>
</html>
