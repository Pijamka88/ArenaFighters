<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Chaos Fighter</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background: #f0f0f0;
        }

        #app {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        .interface {
            width: 100%;
            max-width: 600px;
            padding: 20px;
            box-sizing: border-box;
        }

        .health-bar, .energy-bar {
            width: 100%;
            height: 20px;
            background: #eee;
            margin: 10px 0;
            border-radius: 5px;
            position: relative;
        }

        .health-bar .bar {
            height: 100%;
            background: green;
        }

        .energy-bar .bar {
            height: 100%;
            background: blue;
        }

        .battle-log {
            width: 100%;
            height: 200px;
            overflow-y: auto;
            margin: 20px 0;
            border: 1px solid #ccc;
            padding: 10px;
        }

        .log {
            height: 100%;
            overflow-y: auto;
        }

        .log p {
            margin: 5px 0;
        }

        .log p.player { color: green; }
        .log p.enemy { color: red; }
        .log p.system { color: blue; font-weight: bold; }

        .buttons {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 20px;
        }

        button {
            padding: 20px;
            margin: 5px;
            width: 100%;
            max-width: 300px;
            font-size: 1.2em;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .characters {
            display: flex;
            justify-content: space-around;
            width: 100%;
            margin: 20px 0;
        }

        .player-character, .enemy-character {
            width: 100px;
            height: 100px;
            border-radius: 50%;
        }

        .player-character { background: green; }
        .enemy-character { background: red; }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .attack-animation {
            animation: pulse 0.5s;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="interface">
            <div class="health-bar">
                <div class="bar player-health" style="width: 100%"></div>
            </div>
            <div class="energy-bar">
                <div class="bar player-energy" style="width: 100%"></div>
            </div>
            <div class="characters">
                <div class="player-character"></div>
                <div class="enemy-character"></div>
            </div>
            <div class="battle-log">
                <div class="log"></div>
            </div>
            <div class="buttons">
                <button id="start-button">Начать игру</button>
            </div>
        </div>
    </div>

    <script>
        let player = {
            level: 1,
            health: 100,
            maxHealth: 100,
            attack: 10,
            energy: 50,
            maxEnergy: 50,
            specialCD: 0
        };

        let currentEnemy = null;

        const log = document.querySelector('.log');

        function generateEnemy() {
            return {
                level: player.level,
                health: 100 + player.level * 20,
                attack: 10 + player.level * 5
            };
        }

        function updateBars() {
            document.querySelector('.player-health').style.width = (player.health / player.maxHealth * 100) + '%';
            document.querySelector('.player-energy').style.width = (player.energy / player.maxEnergy * 100) + '%';
        }

        function logMessage(text, type = 'system') {
            const msg = document.createElement('p');
            msg.textContent = text;
            msg.className = type;
            log.appendChild(msg);
            log.scrollTop = log.scrollHeight;
        }

        function showAttackButtons() {
            const buttons = document.querySelector('.buttons');
            buttons.innerHTML = `
                <button id="normal-attack">Обычная атака</button>
                <button id="special-attack" ${player.energy < 20 || player.specialCD > 0 ? 'disabled' : ''}>Специальная атака</button>
            `;

            document.getElementById('normal-attack').addEventListener('click', () => performAttack('normal'));
            document.getElementById('special-attack').addEventListener('click', () => performAttack('special'));
        }

        function performAttack(type) {
            if (type === 'special' && (player.energy < 20 || player.specialCD > 0)) return;

            if (type === 'special') {
                player.energy -= 20;
                player.specialCD = 3;
            }

            const damage = type === 'normal' ? player.attack : player.attack * 2;
            currentEnemy.health -= damage;

            logMessage(`Вы нанесли ${damage} урона!`, 'player');
            document.querySelector('.player-character').classList.add('attack-animation');
            setTimeout(() => document.querySelector('.player-character').classList.remove('attack-animation'), 500);

            updateBars();

            if (currentEnemy.health <= 0) {
                endBattle('victory');
                return;
            }

            setTimeout(() => {
                const enemyDamage = currentEnemy.attack;
                player.health -= enemyDamage;
                logMessage(`Враг нанес ${enemyDamage} урона!`, 'enemy');
                document.querySelector('.enemy-character').classList.add('attack-animation');
                setTimeout(() => document.querySelector('.enemy-character').classList.remove('attack-animation'), 500);

                updateBars();

                if (player.health <= 0) {
                    endBattle('defeat');
                    return;
                }

                showAttackButtons();
                player.specialCD--;
            }, 1000);
        }

        function startBattle() {
            currentEnemy = generateEnemy();
            logMessage('Начало боя!', 'system');
            showAttackButtons();
        }

        function endBattle(result) {
            if (result === 'victory') {
                logMessage('Победа! Вы получили новый уровень!', 'system');
                levelUp();
            } else {
                logMessage('Поражение! Игра окончена.', 'system');
            }

            resetUI();
        }

        function levelUp() {
            player.level++;
            player.maxHealth += 20;
            player.health = player.maxHealth;
            player.attack += 5;
            player.maxEnergy += 10;
            player.energy = player.maxEnergy;
            logMessage(`Уровень ${player.level}!`, 'system');
        }

        function resetUI() {
            document.querySelector('.buttons').innerHTML = '<button id="start-button">Начать новый бой</button>';
            document.getElementById('start-button').addEventListener('click', startBattle);
            document.querySelector('.log').innerHTML = '';
        }

        document.getElementById('start-button').addEventListener('click', startBattle);

        setInterval(() => {
            if (player.energy < player.maxEnergy) player.energy++;
            if (player.specialCD > 0) player.specialCD--;
            updateBars();
        }, 1000);
    </script>
</body>
</html>
