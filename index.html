<!DOCTYPE html>
<html>
<head>
    <title>Arena Fight</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            background: #1a1a1a;
            display: flex;
            flex-direction: column;
            align-items: center;
            color: white;
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
        }

        .arena {
            width: 320px;
            height: 240px;
            border: 3px solid #444;
            border-radius: 10px;
            margin: 20px;
            position: relative;
            background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAAAIklEQVQIW2NkQAKrVq36zwjjgzhhYWGMYAEYB8RmROaABADeOQ8CXl/xfgAAAABJRU5ErkJggg==');
        }

        .fighter {
            position: absolute;
            width: 60px;
            height: 80px;
            bottom: 20px;
            transition: transform 0.3s;
            background-color: #3498db;
            border-radius: 5px;
        }

        #player {
            left: 40px;
        }

        #bot {
            right: 40px;
            background-color: #e74c3c;
        }

        .health-bar {
            width: 100px;
            height: 12px;
            background: #444;
            position: absolute;
            top: -30px;
            border-radius: 3px;
            overflow: hidden;
        }

        .health {
            height: 100%;
            background: #27ae60;
            transition: width 0.3s;
        }

        button {
            padding: 12px 24px;
            font-size: 18px;
            background: #e74c3c;
            border: none;
            border-radius: 5px;
            color: white;
            margin: 10px;
            cursor: pointer;
        }

        #result {
            font-size: 24px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            margin: 20px;
        }

        .stats {
            position: absolute;
            top: -50px;
            font-size: 12px;
            color: #95a5a6;
        }

        .attacking {
            transform: translateY(-20px);
        }
    </style>
</head>
<body>
    <div class="arena">
        <div id="player" class="fighter">
            <div class="stats">ATK: 10-20</div>
            <div class="health-bar">
                <div class="health" id="player-health"></div>
            </div>
        </div>
        <div id="bot" class="fighter">
            <div class="stats">ATK: 8-15</div>
            <div class="health-bar">
                <div class="health" id="bot-health"></div>
            </div>
        </div>
    </div>
    <button id="start-battle">‚öîÔ∏è Start Battle</button>
    <div id="result"></div>

    <script>
        class Fighter {
            constructor(health, minDmg, maxDmg, elementId) {
                this.maxHealth = health;
                this.health = health;
                this.minDmg = minDmg;
                this.maxDmg = maxDmg;
                this.element = document.getElementById(elementId);
            }

            attack(target) {
                const damage = Math.floor(Math.random() * (this.maxDmg - this.minDmg + 1)) + this.minDmg;
                target.takeDamage(damage);
                this.animateAttack();
                return damage;
            }

            takeDamage(amount) {
                this.health = Math.max(0, this.health - amount);
                this.updateHealthBar();
            }

            animateAttack() {
                this.element.classList.add('attacking');
                setTimeout(() => this.element.classList.remove('attacking'), 300);
            }

            updateHealthBar() {
                const healthBar = this.element.querySelector('.health');
                healthBar.style.width = `${(this.health / this.maxHealth) * 100}%`;
            }

            isAlive() {
                return this.health > 0;
            }
        }

        class ArenaGame {
            constructor() {
                this.player = new Fighter(120, 10, 20, 'player');
                this.bot = new Fighter(100, 8, 15, 'bot');
                this.battleInterval = null;
                this.initTelegram();
            }

            initTelegram() {
                Telegram.WebApp.ready();
                Telegram.WebApp.expand();
                Telegram.WebApp.MainButton.setText('Close').onClick(() => Telegram.WebApp.close());
            }

            startBattle() {
                if (this.battleInterval) return;

                this.battleInterval = setInterval(() => {
                    const playerDmg = this.player.attack(this.bot);
                    this.logDamage('Player', playerDmg);
                    
                    if (!this.bot.isAlive()) {
                        this.endBattle('üéâ You Win!');
                        return;
                    }

                    setTimeout(() => {
                        const botDmg = this.bot.attack(this.player);
                        this.logDamage('Bot', botDmg);
                        
                        if (!this.player.isAlive()) {
                            this.endBattle('üíÄ Bot Wins!');
                        }
                    }, 500);
                }, 1500);
            }

            endBattle(result) {
                clearInterval(this.battleInterval);
                this.battleInterval = null;
                document.getElementById('result').textContent = result;
                Telegram.WebApp.MainButton.show();
            }

            logDamage(source, damage) {
                console.log(`${source} hits for ${damage} damage!`);
            }

            resetGame() {
                this.player = new Fighter(120, 10, 20, 'player');
                this.bot = new Fighter(100, 8, 15, 'bot');
                document.getElementById('result').textContent = '';
                Telegram.WebApp.MainButton.hide();
            }
        }

        const game = new ArenaGame();

        document.getElementById('start-battle').addEventListener('click', () => {
            game.resetGame();
            game.startBattle();
        });
    </script>
</body>
</html>