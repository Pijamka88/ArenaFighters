<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medieval Chaos Fighters</title>
    <style>
        body {
            font-family: 'Old English Text MT', fantasy;
            background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAAAIklEQVQIW2NkQAKrVq36zwjjgzhhYWGMYAEYB8RmROaABADeOQ8CXl/xfgAAAABJRU5ErkJggg==');
            color: #d4af37;
            text-align: center;
            touch-action: manipulation;
        }

        #mainMenu, #battleScreen, #statsScreen, #upgradeScreen {
            display: none;
            padding: 20px;
        }

        .active-screen {
            display: block !important;
        }

        button {
            background: #6b0f1a;
            border: 2px solid #d4af37;
            color: white;
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            font-family: inherit;
        }

        .health-bar {
            width: 100px;
            height: 10px;
            background: #444;
            margin: 5px auto;
            border: 1px solid #000;
        }

        .health-fill {
            height: 100%;
            background: #6b0f1a;
            transition: width 0.3s;
        }

        .character {
            font-size: 48px;
            margin: 20px;
            position: relative;
        }

        #arena {
            display: flex;
            justify-content: space-around;
            margin: 30px 0;
        }

        .stats {
            background: rgba(0,0,0,0.7);
            padding: 10px;
            border: 1px solid #d4af37;
            margin: 10px auto;
            width: 80%;
        }
    </style>
</head>
<body>
    <!-- Main Menu -->
    <div id="mainMenu" class="active-screen">
        <h1>üõ°Ô∏è Medieval Chaos üó°Ô∏è</h1>
        <button onclick="startGame()">Start Battle</button>
        <button onclick="showScreen('statsScreen')">Player Stats</button>
    </div>

    <!-- Battle Screen -->
    <div id="battleScreen">
        <div id="arena">
            <div class="character">
                <div id="playerIcon">ü¶∏‚ôÇÔ∏è</div>
                <div class="health-bar">
                    <div id="playerHealth" class="health-fill" style="width: 100%"></div>
                </div>
            </div>
            <div class="character">
                <div id="enemyIcon">üíÄ</div>
                <div class="health-bar">
                    <div id="enemyHealth" class="health-fill" style="width: 100%"></div>
                </div>
            </div>
        </div>
        <div id="battleLog"></div>
        <button onclick="showScreen('mainMenu')">Main Menu</button>
    </div>

    <!-- Stats Screen -->
    <div id="statsScreen">
        <h2>‚öîÔ∏è Player Stats ‚öîÔ∏è</h2>
        <div class="stats">
            <p>Level: <span id="statLevel">1</span></p>
            <p>Attack: <span id="statAttack">10</span></p>
            <p>Health: <span id="statHealth">100</span></p>
            <p>Defense: <span id="statDefense">5</span></p>
        </div>
        <button onclick="showScreen('mainMenu')">Back</button>
    </div>

    <!-- Upgrade Screen -->
    <div id="upgradeScreen">
        <h2>‚ú® Choose Upgrade ‚ú®</h2>
        <button onclick="upgradeStat('attack')">+ Attack</button>
        <button onclick="upgradeStat('health')">+ Health</button>
        <button onclick="upgradeStat('defense')">+ Defense</button>
    </div>

<script>
let player = {
    level: 1,
    attack: 10,
    maxHealth: 100,
    health: 100,
    defense: 5,
    wins: 0,
    xp: 0
};

let currentEnemy = null;
let battleInterval = null;

const enemies = [
    { name: "Bandit", icon: "üó°Ô∏è", attack: 8, health: 80, defense: 3 },
    { name: "Orc", icon: "üëπ", attack: 12, health: 120, defense: 5 },
    { name: "Warlock", icon: "üßô‚ôÇÔ∏è", attack: 15, health: 90, defense: 4 },
    { name: "Dragon Boss", icon: "üêâ", attack: 25, health: 200, defense: 10 }
];

function showScreen(screenId) {
    document.querySelectorAll('div[id$="Screen"]').forEach(el => 
        el.classList.remove('active-screen'));
    document.getElementById(screenId).classList.add('active-screen');
    updateStatsDisplay();
}

function startGame() {
    player.wins = 0;
    spawnEnemy();
    showScreen('battleScreen');
    startBattle();
}

function spawnEnemy() {
    const isBoss = player.wins >= 5;
    currentEnemy = isBoss ? {...enemies[3]} : 
        {...enemies[Math.floor(Math.random() * 3)]};
    currentEnemy.health = isBoss ? 200 : currentEnemy.health;
    document.getElementById('enemyIcon').textContent = currentEnemy.icon;
    updateHealthBars();
}

function startBattle() {
    clearInterval(battleInterval);
    battleInterval = setInterval(battleStep, 2000);
}

function battleStep() {
    // Player attack
    const playerDamage = Math.max(player.attack - currentEnemy.defense, 1);
    currentEnemy.health -= playerDamage;
    logAction(`You hit for ${playerDamage} damage!`);
    
    if(currentEnemy.health <= 0) {
        endBattle(true);
        return;
    }

    // Enemy attack
    const enemyDamage = Math.max(currentEnemy.attack - player.defense, 1);
    player.health -= enemyDamage;
    logAction(`Enemy hits for ${enemyDamage} damage!`);
    
    if(player.health <= 0) {
        endBattle(false);
        return;
    }

    updateHealthBars();
}

function endBattle(victory) {
    clearInterval(battleInterval);
    if(victory) {
        player.wins++;
        player.xp += 50;
        logAction("Victory! Gained 50 XP");
        if(player.wins % 5 === 0) {
            showScreen('upgradeScreen');
        } else {
            setTimeout(spawnEnemy, 1500);
        }
    } else {
        logAction("You were defeated...");
        showScreen('mainMenu');
    }
}

function upgradeStat(stat) {
    player[stat] += 5;
    player.level++;
    showScreen('battleScreen');
    spawnEn