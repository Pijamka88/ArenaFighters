<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chaos Arena</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: #282c34;
        }

        #menu {
            display: flex;
            justify-content: center;
            padding: 20px;
        }

        .btn {
            padding: 12px 24px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            font-size: 16px;
        }

        #arena {
            position: relative;
            width: 100%;
            height: 400px;
            background: #333;
            border: 2px solid #555;
        }

        .fighter {
            position: absolute;
            width: 100px;
            height: 100px;
            background: red;
            transition: transform 0.2s;
        }

        #player {
            left: 50px;
            top: 150px;
            background-image: url('player.png');
        }

        #enemy {
            right: 50px;
            top: 150px;
            background-image: url('enemy.png');
        }

        #status {
            padding: 10px;
            color: white;
            background: #222;
        }

        .bar {
            height: 20px;
            background: #555;
            margin: 5px 0;
        }

        .health {
            background: #f44336;
        }

        .energy {
            background: #2196F3;
        }

        #statsModal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            text-align: center;
            padding: 20px;
        }

        #characterSheet {
            background: white;
            padding: 20px;
            border-radius: 8px;
            max-width: 300px;
            margin: 100px auto;
        }
    </style>
</head>
<body>
    <div id="menu">
        <button class="btn" onclick="startFight()">Начать бой</button>
        <button class="btn" onclick="showStats()">Характеристики</button>
    </div>

    <div id="arena">
        <div id="player" class="fighter"></div>
        <div id="enemy" class="fighter"></div>
    </div>

    <div id="status">
        <div>Уровень: <span id="level">1</span></div>
        <div>Ход: <span id="turn">0</span></div>
        <div class="bar health" id="healthBar"></div>
        <div class="bar energy" id="energyBar"></div>
        <div id="combatLog"></div>
    </div>

    <div id="statsModal">
        <div id="characterSheet">
            <h3>Характеристики</h3>
            <p>Уровень: <span id="modalLevel"></span></p>
            <p>Здоровье: <span id="modalHealth"></span></p>
            <p>Энергия: <span id="modalEnergy"></span></p>
            <p>Опыт: <span id="modalExp"></span></p>
            <button class="btn" onclick="hideStats()">Закрыть</button>
        </div>
    </div>

<script>
class Character {
    constructor(name, level=1, maxHealth=100, energy=50, exp=0) {
        this.name = name;
        this.level = level;
        this.maxHealth = maxHealth;
        this.currentHealth = maxHealth;
        this.energy = energy;
        this.exp = exp;
    }
}

const player = new Character('Герой');
const enemy = new Character('Враг');

let turn = 0;
let isFighting = false;

function startFight() {
    if (isFighting) return;

    isFighting = true;
    turn = 0;
    const enemyLevel = player.level;
    enemy.maxHealth = 80 + enemyLevel * 10;
    enemy.currentHealth = enemy.maxHealth;
    enemy.attackPower = 10 + enemyLevel * 2;

    updateBars();
    updateStatus();

    const fightInterval = setInterval(() => {
        if (!isFighting) return clearInterval(fightInterval);
        
        turn++;
        const playerDamage = Math.floor(Math.random() * (5 + player.level * 2));
        const enemyDamage = Math.floor(Math.random() * (4 + enemy.level));

        enemy.currentHealth -= playerDamage;
        player.currentHealth -= enemyDamage;

        updateBars();
        updateLog(`Ты нанес ${playerDamage} урона`);
        updateLog(`Враг атаковал на ${enemyDamage}`);

        if (enemy.currentHealth <= 0 || player.currentHealth <= 0) {
            clearInterval(fightInterval);
            isFighting = false;
            endFight();
        }
    }, 1500);
}

function endFight() {
    if (player.currentHealth > 0) {
        player.exp += enemy.level * 10;
        updateLog('Победа! Получено опыта: ' + (enemy.level * 10));
        levelUp();
    } else {
        updateLog('Поражение!');
    }

    resetStats();
}

function levelUp() {
    while (player.exp >= 100 * player.level) {
        player.level++;
        player.maxHealth += 20;
        player.exp -= 100 * (player.level - 1);
        updateLog('Уровень повышен до ' + player.level);
    }
}

function updateBars() {
    const healthBar = document.getElementById('healthBar');
    const energyBar = document.getElementById('energyBar');
    
    healthBar.style.width = `${(player.currentHealth / player.maxHealth) * 100}%`;
    energyBar.style.width = '50%'; // Тут можно добавить логику энергии
}

function updateStatus() {
    document.getElementById('level').textContent = player.level;
    document.getElementById('turn').textContent = turn;
}

function updateLog(text) {
    const log = document.getElementById('combatLog');
    log.textContent = text;
    setTimeout(() => log.textContent = '', 1500);
}

function resetStats() {
    player.currentHealth = player.maxHealth;
    enemy.currentHealth = enemy.maxHealth;
    updateBars();
}

function showStats() {
    document.getElementById('statsModal').style.display = 'block';
    document.getElementById('modalLevel').textContent = player.level;
    document.getElementById('modalHealth').textContent = player.currentHealth + '/' + player.maxHealth;
    document.getElementById('modalEnergy').textContent = player.energy;
    document.getElementById('modalExp').textContent = player.exp;
}

function hideStats() {
    document.getElementById('statsModal').style.display = 'none';
}

// Инициализация
document.addEventListener('DOMContentLoaded', () => {
    updateBars();
});
</script>
</body>
</html>
