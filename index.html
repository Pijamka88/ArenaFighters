<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Arena Fighters</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #1a1a1a;
            font-family: 'Courier New', Courier, monospace;
            color: #f0e6d2;
            text-align: center;
            min-height: 100vh;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        .hidden { display: none; }

        .menu-button {
            background: #4a4a4a;
            border: 2px solid #6b4e3d;
            padding: 15px 30px;
            margin: 10px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.2em;
            transition: all 0.3s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.5);
        }

        .menu-button:hover {
            background: #6b4e3d;
            transform: translateY(-2px);
        }

        .character {
            margin: 20px auto;
            width: 150px;
            height: 150px;
            background: #3a3a3a;
            border: 3px solid #6b4e3d;
            border-radius: 10px;
            position: relative;
        }

        .stat {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 5px 0;
            gap: 10px;
        }

        .health-bar {
            width: 80%;
            height: 20px;
            background: #4a4a4a;
            border: 2px solid #6b4e3d;
            border-radius: 5px;
            margin: 10px auto;
        }

        .health-fill {
            height: 100%;
            background: #c00;
            transition: width 0.5s;
        }

        .battle-container {
            display: flex;
            justify-content: space-around;
            align-items: flex-start;
            flex-wrap: wrap;
        }

        .damage-text {
            position: absolute;
            color: #ff4444;
            font-size: 2em;
            text-shadow: 2px 2px 4px #000;
            animation: floatUp 1s ease-out;
        }

        @keyframes floatUp {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-50px); opacity: 0; }
        }

        .upgrade-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .upgrade-button {
            background: #4a4a4a;
            border: 2px solid #6b4e3d;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            width: 80%;
            transition: all 0.3s;
        }

        .upgrade-button:hover {
            background: #6b4e3d;
            transform: scale(1.05);
        }

        @media (max-width: 600px) {
            .menu-button { width: 90%; }
            .battle-container { flex-direction: column; }
            .character { width: 200px; height: 200px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é -->
        <div id="mainMenu" class="menu">
            <div class="character" id="playerPreview"></div>
            <div class="stat">
                <span>üí´</span><span id="xpDisplay">0/100</span>
            </div>
            <div class="stat">
                <span>‚ù§Ô∏è</span><span id="healthDisplay">100</span>
            </div>
            <button class="menu-button" onclick="startBattle()">–ù–∞—á–∞—Ç—å –±–æ–π</button>
            <button class="menu-button" onclick="showUpgrades()">–ü—Ä–æ–∫–∞—á–∫–∞</button>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –±–æ—è -->
        <div id="battleScreen" class="hidden">
            <div class="battle-container">
                <div class="character" id="playerBattle"></div>
                <div class="character" id="enemyBattle"></div>
            </div>
            <div class="health-bar" id="playerHealthBar"><div class="health-fill"></div></div>
            <div class="health-bar" id="enemyHealthBar"><div class="health-fill"></div></div>
            <button class="menu-button" onclick="continueBattle()">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –±–æ–π</button>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –ø—Ä–æ–∫–∞—á–∫–∏ -->
        <div id="upgradeScreen" class="hidden upgrade-screen">
            <div class="upgrade-button" onclick="upgradeStat('attack')">
                ‚öîÔ∏è –ê—Ç–∞–∫–∞: <span id="attackStat">10</span>
            </div>
            <div class="upgrade-button" onclick="upgradeStat('maxHealth')">
                ‚ù§Ô∏è –ó–¥–æ—Ä–æ–≤—å–µ: <span id="healthStat">100</span>
            </div>
            <div class="upgrade-button" onclick="upgradeStat('armor')">
                üõ°Ô∏è –ë—Ä–æ–Ω—è: <span id="armorStat">5</span>
            </div>
            <button class="menu-button" onclick="backToMenu()">–ù–∞–∑–∞–¥</button>
        </div>
    </div>

    <script>
        const gameState = {
            player: {
                level: 1,
                xp: 0,
                maxHealth: 100,
                currentHealth: 100,
                attack: 10,
                armor: 5,
                skillPoints: 0
            },
            enemy: {
                level: 1,
                maxHealth: 80,
                currentHealth: 80,
                attack: 8
            },
            battleInProgress: false
        };

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
        if(localStorage.getItem('arenaSave')) {
            Object.assign(gameState.player, JSON.parse(localStorage.getItem('arenaSave')));
        }

        function updateDisplays() {
            document.getElementById('xpDisplay').textContent = `${gameState.player.xp}/${gameState.player.level * 100}`;
            document.getElementById('healthDisplay').textContent = gameState.player.currentHealth;
            document.getElementById('attackStat').textContent = gameState.player.attack;
            document.getElementById('healthStat').textContent = gameState.player.maxHealth;
            document.getElementById('armorStat').textContent = gameState.player.armor;
        }

        function startBattle() {
            document.getElementById('mainMenu').classList.add('hidden');
            document.getElementById('battleScreen').classList.remove('hidden');
            gameState.battleInProgress = true;
            generateEnemy();
            updateBattleUI();
            battleLoop();
        }

        function generateEnemy() {
            gameState.enemy.level = gameState.player.level + Math.floor(Math.random() * 2) - 1;
            gameState.enemy.level = Math.max(1, gameState.enemy.level);
            gameState.enemy.maxHealth = 80 + (gameState.enemy.level - 1) * 20;
            gameState.enemy.currentHealth = gameState.enemy.maxHealth;
            gameState.enemy.attack = 8 + (gameState.enemy.level - 1) * 3;
        }

        function updateBattleUI() {
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª–æ—Å –∑–¥–æ—Ä–æ–≤—å—è
            document.querySelector('#playerHealthBar .health-fill').style.width = 
                (gameState.player.currentHealth / gameState.player.maxHealth * 100) + '%';
            document.querySelector('#enemyHealthBar .health-fill').style.width = 
                (gameState.enemy.currentHealth / gameState.enemy.maxHealth * 100) + '%';
        }

        async function battleLoop() {
            while(gameState.battleInProgress) {
                await attackSequence();
                await new Promise(r => setTimeout(r, 1000));
                
                if(gameState.enemy.currentHealth <= 0) {
                    handleVictory();
                    break;
                }
                
                if(gameState.player.currentHealth <= 0) {
                    handleDefeat();
                    break;
                }
            }
        }

        function attackSequence() {
            return new Promise(resolve => {
                // –ê—Ç–∞–∫–∞ –∏–≥—Ä–æ–∫–∞
                const damage = calculateDamage(gameState.player.attack, gameState.enemy.armor);
                gameState.enemy.currentHealth = Math.max(0, gameState.enemy.currentHealth - damage);
                showDamageText('enemyBattle', damage);
                
                // –ê—Ç–∞–∫–∞ –≤—Ä–∞–≥–∞
                setTimeout(() => {
                    const enemyDamage = calculateDamage(gameState.enemy.attack, gameState.player.armor);
                    gameState.player.currentHealth = Math.max(0, gameState.player.currentHealth - enemyDamage);
                    showDamageText('playerBattle', enemyDamage);
                    updateBattleUI();
                    resolve();
                }, 500);
            });
        }

        function calculateDamage(attack, armor
