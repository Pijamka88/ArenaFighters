<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arena Fighters</title>
    <script src="https://kit.fontawesome.com/4e9b4b5d3c.js" crossorigin="anonymous"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Courier New', Courier, monospace;
            background: #1a1a1a;
            color: #fff;
            overflow: hidden;
        }

        .container {
            position: relative;
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .menu {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            padding: 20px;
        }

        .player-stats {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            margin-bottom: 40px;
        }

        .stat {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.2em;
        }

        button {
            background: #444;
            border: 2px solid #666;
            padding: 12px 24px;
            border-radius: 8px;
            color: #fff;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
        }

        button:hover {
            background: #555;
            border-color: #888;
        }

        .battle-screen {
            position: relative;
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            align-items: center;
        }

        .characters {
            position: relative;
            width: 100%;
            height: 60%;
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .character {
            text-align: center;
        }

        .health-bar {
            width: 200px;
            height: 20px;
            background: #444;
            border: 2px solid #666;
            border-radius: 10px;
            margin: 10px 0;
        }

        .health-fill {
            height: 100%;
            background: #f00;
            border-radius: 10px;
            transition: width 0.3s;
        }

        .damage-text {
            position: absolute;
            font-size: 2em;
            color: #ff0;
            text-shadow: 2px 2px #444;
            animation: floatUp 1s ease-out;
        }

        @keyframes floatUp {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-50px); opacity: 0; }
        }

        .enemy {
            text-align: right;
        }

        .battle-log {
            position: absolute;
            bottom: 20px;
            display: flex;
            gap: 20px;
        }

        .popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            gap: 20px;
            font-size: 2em;
            color: #ff0;
            text-shadow: 2px 2px #444;
        }

        @media (max-width: 600px) {
            .stat { font-size: 1em; }
            .damage-text { font-size: 1.5em; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Главное меню -->
        <div class="menu" id="mainMenu">
            <div class="player-stats">
                <div class="stat">
                    <i class="fas fa-user"></i>
                    <span id="playerLevel">Уровень: 1</span>
                </div>
                <div class="stat">
                    <i class="fas fa-heart"></i>
                    <span id="playerHealth">Здоровье: 10</span>
                </div>
                <div class="stat">
                    <i class="fas fa-fist-raised"></i>
                    <span id="playerAttack">Атака: 2</span>
                </div>
                <div class="stat">
                    <i class="fas fa-shield-alt"></i>
                    <span id="playerArmor">Броня: 1</span>
                </div>
                <div class="stat">
                    <i class="fas fa-star"></i>
                    <span id="playerExp">Опыт: 0/10</span>
                </div>
                <div class="stat">
                    <i class="fas fa-coins"></i>
                    <span id="upgradePoints">Очки прокачки: 0</span>
                </div>
            </div>
            <button onclick="startBattle()">Начать бой</button>
            <button onclick="showUpgrade()">Прокачка</button>
        </div>

        <!-- Экран боя -->
        <div class="battle-screen" id="battleScreen">
            <div class="characters">
                <div class="character player" id="playerContainer">
                    <div class="health-bar">
                        <div class="health-fill" id="playerHealthBar"></div>
                    </div>
                    <i class="fas fa-user fa-5x"></i>
                </div>
                <div class="character enemy" id="enemyContainer">
                    <div class="health-bar">
                        <div class="health-fill" id="enemyHealthBar"></div>
                    </div>
                    <i class="fas fa-skull fa-5x"></i>
                </div>
            </div>
            <div class="battle-log" id="battleLog"></div>
        </div>

        <!-- Всплывающее окно -->
        <div class="popup" id="popup">
            <div id="popupMessage"></div>
            <button onclick="resetGame()">Вернуться в меню</button>
        </div>

        <!-- Окно прокачки -->
        <div class="popup" id="upgradePopup">
            <div>Выберите улучшение:</div>
            <button onclick="upgradeStat('attack')">Атака</button>
            <button onclick="upgradeStat('health')">Здоровье</button>
            <button onclick="upgradeStat('armor')">Броня</button>
        </div>
    </div>

    <script>
        let player = {
            level: 1,
            health: 10,
            maxHealth: 10,
            attack: 2,
            armor: 1,
            exp: 0,
            upgradePoints: 0
        };

        let enemy = {
            level: 1,
            health: 10,
            maxHealth: 10,
            attack: 2,
            armor: 1
        };

        let battleInterval;
        let battleTime = 10;

        function startBattle() {
            document.getElementById('mainMenu').style.display = 'none';
            document.getElementById('battleScreen').style.display = 'flex';

            resetBattle();
            generateEnemy();
            updateBattleUI();
            startBattleTimer();
        }

        function resetBattle() {
            clearInterval(battleInterval);
            player.health = player.maxHealth;
            enemy.health = enemy.maxHealth;
            battleTime = 10;
            document.getElementById('battleLog').innerHTML = '';
        }

        function generateEnemy() {
            enemy.level = player.level + Math.floor(Math.random() * 2) - 1;
            enemy.level = Math.max(1, enemy.level);
            enemy.attack = 2 + enemy.level;
            enemy.armor = 1 + Math.floor(enemy.level / 2);
            enemy.maxHealth = 10 + enemy.level * 2;
            enemy.health = enemy.maxHealth;
        }

        function updateBattleUI() {
            document.getElementById('playerHealthBar').style.width = 
                (player.health / player.maxHealth) * 100 + '%';
            document.getElementById('enemyHealthBar').style.width = 
                (enemy.health / enemy.maxHealth) * 100 + '%';
        }

        function startBattleTimer() {
            battleInterval = setInterval(() => {
                if (battleTime <= 0) {
                    endBattle('time');
                } else {
                    battleTime--;
                    performAttack();
                }
            }, 1000);
        }

        function performAttack() {
            // Атака игрока
            let playerDamage = Math.max(1, player.attack - enemy.armor);
            enemy.health -= playerDamage;
            showDamage('enemy', playerDamage);

            // Атака врага
            let enemyDamage = Math.max(1, enemy.attack - player.armor);
            player.health -= enemyDamage;
            showDamage('player', enemyDamage);

            checkBattleEnd();
            updateBattleUI();
        }

        function showDamage(target, amount) {
            const container = document.getElementById(target === 'player' ? 'playerContainer' : 'enemyContainer');
            const damageText = document.createElement('div');
            damageText.className = 'damage-text';
            damageText.textContent = `-${amount}`;
            container.appendChild(damageText);
            setTimeout(() => damageText.remove(), 1000);
        }

        function checkBattleEnd() {
            if (player.health <= 0 || enemy.health <= 0 || battleTime <= 0) {
                clearInterval(battleInterval);
                let result;

                if (player.health > enemy.health) {
                    result = 'win';
                } else if (enemy.health > player.health) {
                    result = 'lose';
                } else {
                    result = 'draw';
                }

                endBattle(result);
            }
        }

        function endBattle(result) {
            const popup = document.getElementById('popup');
            const message = document.getElementById('popupMessage');

            if (result === 'win') {
                const expGained = 5 + enemy.level * 2;
                player.exp += expGained;
                message.innerHTML = `Победа! +${expGained} опыта`;

                if (player.exp >= 10 * player.level) {
                    player.level++;
                    player.upgradePoints++;
                    player.exp = 0;
                    message.innerHTML += `<br>Новый уровень! Очки прокачки: ${player.upgradePoints}`;
                }

                setTimeout(() => {
                    if (confirm('Продолжить бой?')) {
                        startBattle();
                    } else {
                        resetGame();
                    }
                }, 2000);
            } else {
                message.textContent = 'Игрок проиграл!';
                setTimeout(resetGame, 2000);
            }

            popup.style.display = 'flex';
        }

        function resetGame() {
            document.getElementById('popup').style.display = 'none';
            document.getElementById('battleScreen').style.display = 'none';
            document.getElementById('mainMenu').style.display = 'flex';
            updatePlayerStats();
        }

        function updatePlayerStats() {
            document.getElementById('playerLevel').textContent = `Уровень: ${player.level}`;
            document.getElementById('playerHealth').textContent = `Здоровье: ${player.health}/${player.maxHealth}`;
            document.getElementById('playerAttack').textContent = `Атака: ${player.attack}`;
            document.getElementById('playerArmor').textContent = `Броня: ${player.armor}`;
            document.getElementById('playerExp').textContent = `Опыт: ${player.exp}/${10 * player.level}`;
            document.getElementById('upgradePoints').textContent = `Очки прокачки: ${player.upgradePoints}`;
        }

        function showUpgrade() {
            if (player.upgradePoints > 0) {
                document.getElementById('upgradePopup').style.display = 'flex';
            } else {
                alert('Нет очков прокачки!');
            }
        }

        function upgradeStat(stat) {
            if (player.upgradePoints > 0) {
                player.upgradePoints--;
                switch(stat) {
                    case 'attack':
                        player.attack += 1;
                        break;
                    case 'health':
                        player.maxHealth += 2;
                        player.health = player.maxHealth;
                        break;
                    case 'armor':
                        player.armor += 1;
                        break;
                }
                updatePlayerStats();
                document.getElementById('upgradePopup').style.display = 'none';
            }
        }

        // Инициализация
        updatePlayerStats();
    </script>
</body>
</html>
